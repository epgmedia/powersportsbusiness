var touchJS=jQuery.noConflict();var WPtouchWebApp=window.navigator.standalone;var addToHomeConfig={animationIn:"bubble",animationOut:"bubble",startDelay:800,lifespan:1000*60,expire:60*24*30,bottomOffset:12,touchIcon:true,arrow:true,message:WPtouch.add2home_message};if(top.location!=self.location){top.location=self.location.href}function doClassicReady(){touchJS(function(){var f=touchJS("#menu-container > div");touchJS("#tab-inner-wrap-left a").click(function(){f.hide().filter(this.hash).show();touchJS("#tab-inner-wrap-left a").removeClass("selected");touchJS(this).addClass("selected");return false}).filter(":first").click()});touchJS("a#header-menu-toggle").click(function(){touchJS("#main-menu").opacityToggle(380);touchJS(this).toggleClass("menu-toggle-open");return false});touchJS("#main-menu ul li a:not(li.has_children > a)").click(function(){touchJS(this).parent().addClass("active")});touchJS("a#tab-search").click(function(){touchJS("#search-bar").toggleClass("show-search");touchJS(this).toggleClass("search-toggle-open");return false});touchJS("#main-menu").find("li.has_children ul").hide();touchJS("#main-menu ul li.has_children > a").click(function(){touchJS(this).parent().children("ul").opacityToggle(380);touchJS(this).toggleClass("arrow-toggle");touchJS(this).parent().toggleClass("open-tree");return false});if(touchJS("#prowl-message").length){setTimeout(function(){touchJS("#prowl-message").fadeOut(350)},2500)}if(touchJS(".single, .page").length){touchJS(".content img, .content .wp-caption").each(function(){if(touchJS(this).width()<=250&&touchJS(this).width()>100){touchJS(this).addClass("aligncenter")}})}touchJS(".single .p3-img-protect").each(function(){touchJS(".p3-overlay").remove();var f=touchJS(this).html();touchJS(this).replaceWith(f)});touchJS("a#share-post").click(function(){touchJS("#share-absolute").opacityToggle(380).viewportCenter();return false});touchJS("a#share-close").click(function(){touchJS("#inner-ajax #share-absolute").opacityToggle(380);return false});touchJS("li#instapaper a").click(function(){var g=prompt(WPtouch.instapaper_username,"");if(g){var f=prompt(WPtouch.instapaper_password,"");if(!f){f="default"}var h={url:document.location.href,username:g,password:f,title:document.title};WPtouchAjax("instapaper",h,function(i){if(i=="1"){alert(WPtouch.instapaper_saved);touchJS("a#share-close").click()}else{alert(WPtouch.instapaper_try_again);touchJS("li#instapaper a").click()}})}return false});var b=touchJS("#share-absolute").get(0);if(b){var e=touchJS(window).height()+100+"px";b.addEventListener("touchmove",classicTouchMove,false);touchJS("#email a").click(function(){touchJS("a#share-close").click();return true});touchJS("#share-absolute").css("height",e)}touchJS(".commentlist li :first, .commentlist img.avatar:first").addClass("first");touchJS("a.com-toggle").bind("click",function(){touchJS("ol.commentlist").toggleClass("hidden");touchJS("img#com-arrow").toggleClass("com-arrow-down");return false});if(touchJS(window).width()>=480){touchJS("body").addClass("landscape")}else{touchJS("body").addClass("portrait")}window.onorientationchange=function(){var f=window.orientation;switch(f){case 0:case 180:touchJS("body").addClass("portrait").removeClass("landscape");break;case 90:case -90:touchJS("body").addClass("landscape").removeClass("portrait");break;default:touchJS("body").addClass("portrait").removeClass("landscape")}};var d=document.location;var c={beforeSubmit:function(){touchJS("#commentform textarea").addClass("loading")},success:function(){touchJS("#commentform textarea").removeClass("loading").addClass("success");alert(WPtouch.comment_success);setTimeout(function(){touchJS("#commentform textarea").removeClass("success")},1500)},error:function(){touchJS("#commentform textarea").removeClass("loading").addClass("error");alert(WPtouch.comment_failure);setTimeout(function(){touchJS("#commentform textarea").removeClass("error")},3000)},resetForm:true,timeout:10000};if(touchJS.isFunction(jQuery.fn.ajaxForm)){touchJS("#commentform").ajaxForm(c)}loadMoreEntries();loadMoreComments();comReplyArrows();classicExcerptToggle();welcomeMessage();webAppLinks();webAppOnly();touchJS("a.login-req, a.comment-reply-login").bind("click",function(){touchJS("a#header-menu-toggle, a#tab-login").click();scrollTo(0,0,1);return false});if(!touchJS(".single").length){touchJS(window).load(function(){setTimeout(scrollTo,0,0,1)})}touchJS("a.back-to-top").click(function(){scrollTo(0,0,100);return false});jQuery(function(){var f=1;jQuery("input, select, textarea").each(function(){if(this.type!="hidden"){var g=jQuery(this);g.attr("tabindex",f);f++}})});var a=jQuery("#switch a").attr("href");jQuery("#switch :checkbox").iphoneStyle({checkedLabel:WPtouch.toggle_on,uncheckedLabel:WPtouch.toggle_off}).bind("change",function(){if(!jQuery(this).attr("checked")){window.location=a}})}touchJS.fn.opacityToggle=function(a,c,b){return this.animate({opacity:"toggle"},a,c,b)};touchJS.fn.viewportCenter=function(){this.hide().css("position","absolute");this.css("top",(touchJS(window).height()-this.height())/3+touchJS(window).scrollTop()+"px");this.css("left",(touchJS(window).width()-this.width())/2+touchJS(window).scrollLeft()+"px");this.show();return this};function classicTouchMove(a){a.preventDefault()}function welcomeMessage(){if(!WPtouchWebApp){touchJS("#welcome-message").show();touchJS("a#close-msg").bind("click",function(){WPtouchCreateCookie("wptouch_welcome","1",365);touchJS("#welcome-message").fadeOut(350);return false})}}function webAppLinks(){if(WPtouchWebApp){var a=touchJS("a").not(".no-ajax, .email a, .feed a, a#header-menu-toggle, .has_children > a, a.load-more-link, .load-more-comments-link a, a#share-post, a#share-close");a.each(function(){var d=touchJS(this).attr("href");var c=touchJS(this);var b=location.hostname;if(typeof wptouch_ignored_urls!="undefined"){touchJS.each(wptouch_ignored_urls,function(e,f){if(d.match(f)){c.addClass("ignored")}})}if(d.match((/[^\s]+(\.(pdf|numbers|pages|xls|xlsx|doc|docx|zip|tar|gz|csv|txt))$/i))){c.addClass("external")}else{if(d.match((/[^\s]+(\.(jpg|jpeg|gif|png|bmp|tiff))$/i))){c.addClass("img-link")}}touchJS(c).unbind("click").bind("click",function(f){if(touchJS(c).hasClass("external")||touchJS(c).parent("li").hasClass("external")){confirmForExternal=confirm(WPtouch.external_link_text+" \n"+WPtouch.open_browser_text);if(confirmForExternal){return true}else{return false}}else{if(touchJS(c).hasClass("img-link")){return false}else{if(d.match(b)||!d.match("http://")){if(touchJS(c).hasClass("ignored")||touchJS(c).parent("li").hasClass("ignored")){confirmForExternal=confirm(WPtouch.wptouch_ignored_text+" \n"+WPtouch.open_browser_text);if(confirmForExternal){return true}else{return false}}else{if(touchJS("#main-menu").hasClass("show-menu")){touchJS(this).opacityToggle(380);touchJS("a#header-menu-toggle").toggleClass("menu-toggle-open")}loadPage(d);return false}}else{confirmForExternal=confirm(WPtouch.external_link_text+" \n"+WPtouch.open_browser_text);if(confirmForExternal){return true}else{return false}}}}})})}}function loadPage(b){var a=touchJS("body.loadsaved").length;if(touchJS("body.ajax-on").length){touchJS("body").append('<div id="progress"></div>');touchJS("#progress").viewportCenter();touchJS(document).unbind();touchJS("#outer-ajax").load(b+" #inner-ajax",function(c){touchJS("#progress").addClass("done");if(a){WPtouchCreateCookie("wptouch-load-last-url",b,365)}else{WPtouchEraseCookie("wptouch-load-last-url")}doClassicReady();scrollTo(0,0)})}else{touchJS("body").append('<div id="progress"></div>');touchJS("#progress").viewportCenter();if(a){WPtouchCreateCookie("wptouch-load-last-url",b,365)}setTimeout(function(){window.location=b},550)}}function webAppOnly(){if(WPtouchWebApp){var a=touchJS("body.loadsaved").length;if(!a){WPtouchEraseCookie("wptouch-load-last-url")}touchJS("body").addClass("web-app");touchJS("body.black-translucent").css("margin-top","20px");touchJS("#switch, a.comment-reply-link, a.comment-edit-link, #welcome-message").remove();setTimeout(function(){touchJS("#progress").remove()},150)}}function classicExcerptToggle(){touchJS("a.excerpt-button").live("click",function(){touchJS(this).toggleClass("open").parent(".post").find(".content").opacityToggle(380);return false})}function loadMoreEntries(){var a=touchJS("a.load-more-link");var b=".ajax-page-target";a.live("click",function(){touchJS(this).addClass("ajax-spinner").text(WPtouch.loading_text);var c=touchJS(this).attr("rel");touchJS("#content").append("<div class='ajax-page-target'></div>");touchJS(b).hide().load(c+" #content .post, #content .load-more-link",function(){touchJS(this).replaceWith(touchJS(this).html());touchJS("a.load-more-link.ajax-spinner").fadeOut(350);webAppLinks()});return false})}function loadMoreComments(){var a=touchJS("li.load-more-comments-link a");var b=".ajax-page-target";a.live("click",function(){touchJS(this).addClass("ajax-spinner");var c=touchJS(this).attr("href");touchJS("ol.commentlist").append("<div class='ajax-page-target'></div>");touchJS(b).hide().load(c+" ol.commentlist > li",function(){touchJS(this).replaceWith(touchJS(this).html());touchJS(".load-more-comments-link a.ajax-spinner").parent().fadeOut(350);if(WPtouchWebApp){touchJS("a.comment-reply-link, a.comment-edit-link").remove();webAppLinks()}});return false})}function comReplyArrows(){var a=touchJS("ol.commentlist li li > .comment-top");touchJS.each(a,function(){touchJS(a).prepend("<div class='com-down-arrow'></div>")})}function WPtouchCreateCookie(c,d,e){if(e){var b=new Date();b.setTime(b.getTime()+(e*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}document.cookie=c+"="+d+a+"; path="+WPtouch.siteurl}function WPtouchEraseCookie(a){WPtouchCreateCookie(a,"",-1)}touchJS(document).ready(function(){doClassicReady()});
/*!
// iPhone-style Checkboxes jQuery plugin
// Copyright Thomas Reynolds, licensed GPL & MIT
*/
(function(c,d){c[d]=function(b,f){this.$elem=c(b);var a=this;c.each(f,function(h,e){a[h]=e});this.wrapCheckboxWithDivs();this.attachEvents();this.disableTextSelection();if(this.resizeHandle){this.optionallyResize("handle")}if(this.resizeContainer){this.optionallyResize("container")}this.initialPosition()};c.extend(c[d].prototype,{wrapCheckboxWithDivs:function(){this.$elem.wrap('<div class="'+this.containerClass+'" />');this.container=this.$elem.parent();this.offLabel=c('<label class="'+this.labelOffClass+'"><span>'+this.uncheckedLabel+"</span></label>").appendTo(this.container);this.offSpan=this.offLabel.children("span");this.onLabel=c('<label class="'+this.labelOnClass+'"><span>'+this.checkedLabel+"</span></label>").appendTo(this.container);this.onSpan=this.onLabel.children("span");this.handle=c('<div class="'+this.handleClass+'"><div class="'+this.handleRightClass+'"><div class="'+this.handleCenterClass+'" /></div></div>').appendTo(this.container)},disableTextSelection:function(){if(!c.browser.msie){return}c.each([this.handle,this.offLabel,this.onLabel,this.container],function(){c(this).attr("unselectable","on")})},optionallyResize:function(a){var h=this.onLabel.width(),g=this.offLabel.width();if(a=="container"){var b=(h>g)?h:g;b+=this.handle.width()+15}else{var b=(h<g)?h:g}this[a].css({width:b})},attachEvents:function(){var a=this;this.container.bind("mousedown touchstart",function(b){b.preventDefault();if(a.$elem.is(":disabled")){return}var f=b.pageX||b.originalEvent.changedTouches[0].pageX;c[d].currentlyClicking=a.handle;c[d].dragStartPosition=f;c[d].handleLeftOffset=parseInt(a.handle.css("left"),10)||0;c[d].dragStartedOn=a.$elem}).bind("iPhoneDrag",function(g,h){g.preventDefault();if(a.$elem.is(":disabled")){return}if(a.$elem!=c[d].dragStartedOn){return}var b=(h+c[d].handleLeftOffset-c[d].dragStartPosition)/a.rightSide;if(b<0){b=0}if(b>1){b=1}a.handle.css({left:b*a.rightSide});a.onLabel.css({width:b*a.rightSide+4});a.offSpan.css({marginRight:-b*a.rightSide});a.onSpan.css({marginLeft:-(1-b)*a.rightSide})}).bind("iPhoneDragEnd",function(h,j){if(a.$elem.is(":disabled")){return}var i;if(c[d].dragging){var b=(j-c[d].dragStartPosition)/a.rightSide;i=(b<0)?Math.abs(b)<0.5:b>=0.5}else{i=!a.$elem.attr("checked")}a.$elem.attr("checked",i);c[d].currentlyClicking=null;c[d].dragging=null;a.$elem.change()});this.$elem.change(function(){if(a.$elem.is(":disabled")){a.container.addClass(a.disabledClass);return false}else{a.container.removeClass(a.disabledClass)}var b=a.$elem.attr("checked")?a.rightSide:0;a.handle.animate({left:b},a.duration);a.onLabel.animate({width:b+4},a.duration);a.offSpan.animate({marginRight:-b},a.duration);a.onSpan.animate({marginLeft:b-a.rightSide},a.duration)})},initialPosition:function(){this.offLabel.css({width:this.container.width()-5});var a=(c.browser.msie&&c.browser.version<7)?3:6;this.rightSide=this.container.width()-this.handle.width()-a;if(this.$elem.is(":checked")){this.handle.css({left:this.rightSide});this.onLabel.css({width:this.rightSide+4});this.offSpan.css({marginRight:-this.rightSide})}else{this.onLabel.css({width:0});this.onSpan.css({marginLeft:-this.rightSide})}if(this.$elem.is(":disabled")){this.container.addClass(this.disabledClass)}}});c.fn[d]=function(f){var a=this.filter(":checkbox");if(!a.length){return this}var b=c.extend({},c[d].defaults,f);a.each(function(){c(this).data(d,new c[d](this,b))});if(!c[d].initComplete){c(document).bind("mousemove touchmove",function(e){if(!c[d].currentlyClicking){return}e.preventDefault();var h=e.pageX||e.originalEvent.changedTouches[0].pageX;if(!c[d].dragging&&(Math.abs(c[d].dragStartPosition-h)>b.dragThreshold)){c[d].dragging=true}c(e.target).trigger("iPhoneDrag",[h])}).bind("mouseup touchend",function(e){if(!c[d].currentlyClicking){return}e.preventDefault();var h=e.pageX||e.originalEvent.changedTouches[0].pageX;c(c[d].currentlyClicking).trigger("iPhoneDragEnd",[h])});c[d].initComplete=true}return this};c[d].defaults={duration:200,checkedLabel:"ON",uncheckedLabel:"OFF",resizeHandle:true,resizeContainer:true,disabledClass:"iPhoneCheckDisabled",containerClass:"iPhoneCheckContainer",labelOnClass:"iPhoneCheckLabelOn",labelOffClass:"iPhoneCheckLabelOff",handleClass:"iPhoneCheckHandle",handleCenterClass:"iPhoneCheckHandleCenter",handleRightClass:"iPhoneCheckHandleRight",dragThreshold:5}})(jQuery,"iphoneStyle");