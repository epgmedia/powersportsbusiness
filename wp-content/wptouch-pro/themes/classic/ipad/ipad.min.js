var touchJS=jQuery.noConflict();var WPtouchWebApp=window.navigator.standalone;var addToHomeConfig={animationIn:"bubble",animationOut:"bubble",startDelay:800,lifespan:1000*60,expire:60*24*30,bottomOffset:12,touchIcon:true,arrow:true,message:WPtouch.add2home_message};if(top.location!=self.location){top.location=self.location.href}if(navigator.platform=="iPad"&&typeof orientation!="undefined"){var touchStartOrClick="touchstart";var touchEndOrClick="touchend"}else{var touchStartOrClick="click";var touchEndOrClick="click"}function doClassiciPadReady(){document.addEventListener("touchmove",function(g){g.preventDefault()});window.addEventListener("orientationchange",function(){classicUpdateOrientation()});classicMainScroll=new iScroll("iscroll-wrapper",{bounceLock:true,hScrollbar:false});if(touchJS("#pages-wrapper").length){classicPagesScroll=new iScroll("pages-wrapper")}else{classicPagesScroll=classicMainScroll}if(touchJS("#recent-wrapper").length){classicRecentScroll=new iScroll("recent-wrapper")}else{classicRecentScroll=classicMainScroll}if(touchJS("#popular-wrapper").length){classicPopularScroll=new iScroll("popular-wrapper")}else{classicPopularScroll=classicMainScroll}if(touchJS("#tags-wrapper").length){classicTagsScroll=new iScroll("tags-wrapper")}else{classicTagsScroll=classicMainScroll}if(touchJS("#cats-wrapper").length){classicCatsScroll=new iScroll("cats-wrapper")}else{classicCatsScroll=classicMainScroll}if(touchJS("#flickr-wrapper").length){classicFlickrScroll=new iScroll("flickr-wrapper")}else{classicFlickrScroll=classicMainScroll}if(touchJS("#wordtwit-wrapper").length){classicWordTwitScroll=new iScroll("wordtwit-wrapper")}else{classicWordTwitScroll=classicMainScroll}touchJS(".head-left div.menubar-button").bind(touchEndOrClick,function(){var h="#pop-"+touchJS(this).attr("id");var g=touchJS(this).offset();touchJS(h).css({top:g.top+32+"px",left:g.left+"px"}).popOverToggle();touchJS(h+" .menu-pointer-arrow").css("left","20px");headerDismissSpan();setTimeout(function(){allScrollsRefresh()},0)});touchJS(".head-right div.menubar-button").bind(touchEndOrClick,function(){var h="#pop-"+touchJS(this).attr("id");var g=touchJS(this).offset();touchJS(h).css({top:g.top+32+"px",left:g.left-touchJS(h).width()/1.45}).popOverToggle();touchJS(h+" .menu-pointer-arrow").css("right","58px");headerDismissSpan();setTimeout(function(){allScrollsRefresh()},0)});touchJS(".head-center h1").bind(touchStartOrClick,function(){classicMainScroll.scrollTo(0,0,500)});touchJS(function(){var g=touchJS("#pop-blog > div");touchJS("ul.menu-tabs a").bind(touchStartOrClick,function(h){g.hide().filter(this.rel).show();touchJS("ul.menu-tabs a").removeClass("selected");touchJS(this).addClass("selected");h.preventDefault();setTimeout(function(){allScrollsRefresh()},0)}).filter(":first").trigger(touchStartOrClick)});touchJS("#popovers-container .pop-inner li a, #pages-wrapper a").live("click",function(){touchJS(this).parent().toggleClass("highlight")});var b=".button, .content a, .title-area a, #switch a, .footer a";touchJS(b).live(touchStartOrClick,function(){touchJS(this).toggleClass("active")}).live(touchEndOrClick,function(){touchJS(this).toggleClass("active")});touchJS("#pages-wrapper").find("li.has_children ul").hide();touchJS("#pages-wrapper ul li.has_children > a").unbind("click").bind("click",function(){touchJS(this).next().webkitSlideToggle(350);touchJS(this).toggleClass("arrow-toggle");touchJS(this).parent().toggleClass("open-tree");setTimeout(function(){classicPagesScroll.refresh()},0);return false});touchJS("a.share-post").unbind("click").bind(touchStartOrClick,function(){var g=touchJS(this).offset();touchJS("#share-popover").css({top:g.top-260+"px",left:g.left-25+"px",}).fadeIn(350);headerDismissSpan();return false});touchJS("#respond").detach().appendTo(".comment-reply-box .pop-inner").css("display","block");touchJS("#share-placeholder").detach().appendTo("#share-popover").css("display","block");touchJS("a.leave-a-comment, .comments-close-button").unbind("click").bind(touchEndOrClick,function(){touchJS(".comment-reply-box").toggleClass("fly-in").flyInToggle();touchJS("input#comment_parent").val("0");touchJS("#box-head h3").html(WPtouch.leave_a_comment);touchJS("#peek").hide();touchJS("#container1 textarea").removeClass("reply");touchJS("#commentform input, #commentform textarea").blur();return false});touchJS("#peek").unbind("click").bind(touchEndOrClick,function(){touchJS("#container1").toggleClass("slide");touchJS("#container2").toggleClass("slide2");return false});touchJS("a.comment-reply-login, a.reply-to-comment").bind(touchStartOrClick,function(){touchJS("#account.menubar-button").trigger(touchEndOrClick);return false});if(touchJS(".post").length){touchJS(".content img, .content .wp-caption").each(function(){if(touchJS(this).width()>=350){touchJS(this).addClass("aligncenter")}})}touchJS("textarea, form#prowl-direct-message input, form#loginform input").bind("blur",function(){scrollTo(0,0,100)});touchJS("li#instapaper a").click(function(){var h=prompt(WPtouch.instapaper_username,"");if(h){var g=prompt(WPtouch.instapaper_password,"");if(!g){g="default"}var i={url:document.location.href,username:h,password:g,title:document.title};WPtouchAjax("instapaper",i,function(j){if(j=="1"){alert(WPtouch.instapaper_saved);touchJS("#share-popover").fadeOut(350)}else{alert(WPtouch.instapaper_try_again)}})}return false});var f=document.location;var d={beforeSubmit:function(){touchJS("#container1").append('<div id="comment-spinner"></div>')},success:function(){touchJS("ol.commentlist").load(f+" ol.commentlist > li",function(){touchJS("#comment-spinner").remove();touchJS("#container1 textarea").addClass("success");commentReplyLinks()});setTimeout(function(){touchJS(".comments-close-button").trigger(touchEndOrClick);touchJS("#container1 textarea").removeClass("success");classicMainScroll.refresh()},1500)},error:function(){touchJS("#comment-spinner").remove();touchJS("#container1 textarea").addClass("error");touchJS("#container1").prepend('<div id="error-text">'+WPtouch.comment_failure+"</div>");setTimeout(function(){touchJS("#container1 textarea").removeClass("error");touchJS("#error-text").remove()},3000)},resetForm:true,timeout:7500};if(touchJS.isFunction(jQuery.fn.ajaxForm)){touchJS("#commentform").ajaxForm(d)}var e={beforeSubmit:function c(k,j,g){for(var h=0;h<k.length;h++){if(!k[h].value){alert(WPtouch.validation_message);return false}touchJS("#prowl-direct-message p").prepend('<div id="prowl-spinner"></div>')}},success:function(){touchJS("#prowl-spinner").remove();touchJS("#prowl-direct-message textarea").addClass("success");setTimeout(function(){touchJS("#message").trigger(touchEndOrClick);touchJS("#prowl-direct-message textarea").removeClass("success")},1000)},error:function(){touchJS("#prowl-spinner").remove();touchJS("#prowl-direct-message textarea").addClass("error");touchJS("#prowl-direct-message").prepend('<div id="prowl-error-text">'+WPtouch.prowl_failure+"</div>");setTimeout(function(){touchJS("#prowl-direct-message textarea").removeClass("error");touchJS("#prowl-error-text").remove()},4000)},resetForm:true,timeout:3500};if(touchJS.isFunction(jQuery.fn.ajaxForm)){touchJS("#prowl-direct-message").ajaxForm(e)}touchJS(window).load(function(){var g=touchJS("#welcome-message").length;var h=touchJS("div.comment-reply-box").height()+150;touchJS("div.comment-reply-box").css("-webkit-transform","translateY(-"+h+"px) rotate(-10deg)").show();if(g){touchJS("#welcome-message").show()}setTimeout(function(){touchJS("#iscroll-wrapper").addClass("in-display");classicMainScroll.refresh()},0)});jQuery(function(){var g=1;jQuery("input, select, textarea").each(function(){if(this.type!="hidden"){var h=jQuery(this);h.attr("tabindex",g);g++}})});var a=jQuery("#switch a").attr("href");jQuery("#switch :checkbox").iphoneStyle({checkedLabel:WPtouch.toggle_on,uncheckedLabel:WPtouch.toggle_off}).bind("change",function(){if(!jQuery(this).attr("checked")){window.location=a}});classicUpdateOrientation();loadMoreEntries();commentReplyLinks();loadMoreComments();welcomeMessage();webAppLinks();webAppOnly()}function allScrollsRefresh(){classicMainScroll.refresh();classicPagesScroll.refresh();classicRecentScroll.refresh();classicPopularScroll.refresh();classicTagsScroll.refresh();classicCatsScroll.refresh();classicFlickrScroll.refresh();classicWordTwitScroll.refresh()}function classicUpdateOrientation(){var d=touchJS(window).height()-44;var a=touchJS("#logo-area").height();var c=d-a;var b=WPtouchReadCookie("wptouch-ipad-orientation");switch(window.orientation){case 0:case 180:touchJS("body").removeClass("landscape").addClass("portrait");touchJS("#iscroll-wrapper").css("height",d);touchJS("#main-menu #pages-wrapper").detach().appendTo("#pop-menu .pop-inner").css("height","auto").css("max-height","500px");touchJS(".popover.open").each(function(){touchJS(this).removeClass("open").hide()});WPtouchCreateCookie("wptouch-ipad-orientation","portrait",365);break;case 90:case -90:default:touchJS("body").removeClass("portrait").addClass("landscape");touchJS("#iscroll-wrapper").css("height",d);touchJS("#pages-wrapper").detach().appendTo("#main-menu").css("height",c).css("max-height","none");touchJS(".popover.open").each(function(){touchJS(this).removeClass("open").hide()});WPtouchCreateCookie("wptouch-ipad-orientation","landscape",365)}setTimeout(function(){allScrollsRefresh()},750)}function headerDismissSpan(){if(!touchJS("#dismiss-underlay").length){touchJS("body").append('<span id="dismiss-underlay"></span>');touchJS("#dismiss-underlay").bind(touchStartOrClick,function(a){touchJS("#popovers-container .popover.open").removeClass("open").fadeOut(350);touchJS("#share-popover").fadeOut(350);touchJS(this).remove();return false})}else{touchJS("#dismiss-underlay").remove()}}function loadMoreEntries(){var a=touchJS("a.load-more-link");var b=".ajax-page-target";if(a.length){a.unbind("click").live("click",function(){touchJS("a.load-more-link span").addClass("ajax-spinner");var c=touchJS(this).attr("href");touchJS("#content").append("<div class='ajax-page-target'></div>");touchJS(b).hide().load(c+" #content .post, #content .load-more-link",function(){touchJS(this).replaceWith(touchJS(this).html());touchJS("span.ajax-spinner").parent().fadeOut(350);setTimeout(function(){classicMainScroll.refresh()},0);webAppLinks()});return false})}}function loadMoreComments(){var a=touchJS("ol.commentlist li.load-more-comments-link a");if(a.length){a.unbind("click").live("click",function(){var b=touchJS(this).attr("href");touchJS(this).addClass("ajax-spinner").delay(1250).fadeOut(350);touchJS("ol.commentlist").append("<div class='ajax-page-target'></div>");touchJS("div.ajax-page-target").hide().load(b+" ol.commentlist > li",function(){touchJS(this).replaceWith(touchJS(this).html());commentReplyLinks();setTimeout(function(){classicMainScroll.refresh()},0);webAppLinks()});return false})}}function commentReplyLinks(){touchJS(".commentlist a.comment-reply-link").unbind("click").bind(touchStartOrClick,function(){var a=touchJS(this).closest("li.comment").attr("ID");var b=touchJS("#"+a).find("span.fn:first").text();var d=touchJS(".commentlist ol").attr("ID");var c=touchJS("li#"+a+" .comment-content:first > p").text();touchJS(".comment-reply-box").addClass("fly-in").flyInToggle();touchJS("#box-head h3").html(WPtouch.leave_a_reply+" <span>"+b+"</span>");touchJS("#peek").show();touchJS("input#comment_parent").val(a);touchJS("#container1 textarea").addClass("reply");touchJS("#container2").html(c);return false})}function webAppLinks(){if(WPtouchWebApp){var a=touchJS("a").not(".no-ajax, .email a, .button, .comment-buttons a, ul.menu-tabs a, #pages-wrapper .has_children > a, a.load-more-link, .load-more-comments-link a, #share-popover a");a.each(function(){var d=touchJS(this).attr("href");var c=touchJS(this);var b=location.protocol+"//"+location.hostname;if(typeof wptouch_ignored_urls!="undefined"){touchJS.each(wptouch_ignored_urls,function(e,f){if(d.match(f)){c.addClass("ignored")}})}if(d.match((/[^\s]+(\.(pdf|numbers|pages|xls|xlsx|doc|docx|zip|tar|gz|csv|txt))$/i))){c.addClass("external")}else{if(d.match((/[^\s]+(\.(jpg|jpeg|gif|png|bmp|tiff))$/i))){c.addClass("img-link")}}touchJS(c).unbind("click").bind("click",function(f){if(touchJS(c).hasClass("external")||touchJS(c).parent("li").hasClass("external")){confirmForExternal=confirm(WPtouch.external_link_text+" \n"+WPtouch.open_browser_text);if(confirmForExternal){return true}else{f.preventDefault();f.stopImmediatePropagation()}}else{if(touchJS(c).hasClass("img-link")){return false}else{if(d.match(b)||!d.match("http://")){if(touchJS(c).hasClass("ignored")||touchJS(c).parent("li").hasClass("ignored")){confirmForExternal=confirm(WPtouch.wptouch_ignored_text+" \n"+WPtouch.open_browser_text);if(confirmForExternal){return true}else{f.preventDefault();f.stopImmediatePropagation()}}else{WPtouchCreateCookie("wptouch-load-last-url",d,365);window.location=d;f.preventDefault()}}else{confirmForExternal=confirm(WPtouch.external_link_text+" \n"+WPtouch.open_browser_text);if(confirmForExternal){return true}else{f.preventDefault();f.stopImmediatePropagation()}}}}})})}}function webAppOnly(){if(WPtouchWebApp){var a=touchJS("body.loadsaved").length;touchJS("body").addClass("web-app");touchJS("#account-link-area, #switch, #welcome-message").remove();if(!a){WPtouchEraseCookie("wptouch-load-last-url")}touchJS(".post a").has("img").each(function(){touchJS(this).click(function(c){var b=touchJS(this).attr("href");if(b.match(".jpg")||b.match(".png")||b.match(".jpeg")||b.match(".gif")){c.preventDefault();c.stopImmediatePropagation()}})})}}function welcomeMessage(){if(!WPtouchWebApp){touchJS("a#close-msg").unbind("click").bind("click",function(){WPtouchCreateCookie("wptouch_welcome","1",365);touchJS("#welcome-message").fadeOut(350);return false})}}touchJS.fn.popOverToggle=function(){if(!this.hasClass("open")){this.show().addClass("open")}else{this.removeClass("open").fadeOut(350)}};touchJS.fn.flyInToggle=function(){var a=this.height()+150;if(this.hasClass("fly-in")){this.css("-webkit-transform","translateY(0px) rotate(0deg)").css("opacity","1").css("-webkit-transition","350ms")}else{this.css("-webkit-transform","translateY(-"+a+"px) rotate(-10deg)").css("opacity",".5").css("-webkit-transition","350ms")}};touchJS.fn.webkitSlideToggle=function(){if(!this.hasClass("slide-in")){this.show().addClass("slide-in")}else{this.slideUp(350).removeClass("slide-in")}};function WPtouchCreateCookie(c,d,e){if(e){var b=new Date();b.setTime(b.getTime()+(e*24*60*60*1000));var a="; expires="+b.toGMTString()}else{var a=""}document.cookie=c+"="+d+a+"; path="+WPtouch.siteurl}function WPtouchReadCookie(b){var e=b+"=";var a=document.cookie.split(";");for(var d=0;d<a.length;d++){var f=a[d];while(f.charAt(0)==" "){f=f.substring(1,f.length)}if(f.indexOf(e)==0){return f.substring(e.length,f.length)}}return null}function WPtouchEraseCookie(a){WPtouchCreateCookie(a,"",-1)}touchJS(document).ready(function(){doClassiciPadReady()});
/*!
// iPhone-style Checkboxes jQuery plugin
// Copyright Thomas Reynolds, licensed GPL & MIT
*/
(function(c,d){c[d]=function(b,f){this.$elem=c(b);var a=this;c.each(f,function(h,e){a[h]=e});this.wrapCheckboxWithDivs();this.attachEvents();this.disableTextSelection();if(this.resizeHandle){this.optionallyResize("handle")}if(this.resizeContainer){this.optionallyResize("container")}this.initialPosition()};c.extend(c[d].prototype,{wrapCheckboxWithDivs:function(){this.$elem.wrap('<div class="'+this.containerClass+'" />');this.container=this.$elem.parent();this.offLabel=c('<label class="'+this.labelOffClass+'"><span>'+this.uncheckedLabel+"</span></label>").appendTo(this.container);this.offSpan=this.offLabel.children("span");this.onLabel=c('<label class="'+this.labelOnClass+'"><span>'+this.checkedLabel+"</span></label>").appendTo(this.container);this.onSpan=this.onLabel.children("span");this.handle=c('<div class="'+this.handleClass+'"><div class="'+this.handleRightClass+'"><div class="'+this.handleCenterClass+'" /></div></div>').appendTo(this.container)},disableTextSelection:function(){if(!c.browser.msie){return}c.each([this.handle,this.offLabel,this.onLabel,this.container],function(){c(this).attr("unselectable","on")})},optionallyResize:function(a){var h=this.onLabel.width(),g=this.offLabel.width();if(a=="container"){var b=(h>g)?h:g;b+=this.handle.width()+15}else{var b=(h<g)?h:g}this[a].css({width:b})},attachEvents:function(){var a=this;this.container.bind("mousedown touchstart",function(b){b.preventDefault();if(a.$elem.is(":disabled")){return}var f=b.pageX||b.originalEvent.changedTouches[0].pageX;c[d].currentlyClicking=a.handle;c[d].dragStartPosition=f;c[d].handleLeftOffset=parseInt(a.handle.css("left"),10)||0;c[d].dragStartedOn=a.$elem}).bind("iPhoneDrag",function(g,h){g.preventDefault();if(a.$elem.is(":disabled")){return}if(a.$elem!=c[d].dragStartedOn){return}var b=(h+c[d].handleLeftOffset-c[d].dragStartPosition)/a.rightSide;if(b<0){b=0}if(b>1){b=1}a.handle.css({left:b*a.rightSide});a.onLabel.css({width:b*a.rightSide+4});a.offSpan.css({marginRight:-b*a.rightSide});a.onSpan.css({marginLeft:-(1-b)*a.rightSide})}).bind("iPhoneDragEnd",function(h,j){if(a.$elem.is(":disabled")){return}var i;if(c[d].dragging){var b=(j-c[d].dragStartPosition)/a.rightSide;i=(b<0)?Math.abs(b)<0.5:b>=0.5}else{i=!a.$elem.attr("checked")}a.$elem.attr("checked",i);c[d].currentlyClicking=null;c[d].dragging=null;a.$elem.change()});this.$elem.change(function(){if(a.$elem.is(":disabled")){a.container.addClass(a.disabledClass);return false}else{a.container.removeClass(a.disabledClass)}var b=a.$elem.attr("checked")?a.rightSide:0;a.handle.animate({left:b},a.duration);a.onLabel.animate({width:b+4},a.duration);a.offSpan.animate({marginRight:-b},a.duration);a.onSpan.animate({marginLeft:b-a.rightSide},a.duration)})},initialPosition:function(){this.offLabel.css({width:this.container.width()-5});var a=(c.browser.msie&&c.browser.version<7)?3:6;this.rightSide=this.container.width()-this.handle.width()-a;if(this.$elem.is(":checked")){this.handle.css({left:this.rightSide});this.onLabel.css({width:this.rightSide+4});this.offSpan.css({marginRight:-this.rightSide})}else{this.onLabel.css({width:0});this.onSpan.css({marginLeft:-this.rightSide})}if(this.$elem.is(":disabled")){this.container.addClass(this.disabledClass)}}});c.fn[d]=function(f){var a=this.filter(":checkbox");if(!a.length){return this}var b=c.extend({},c[d].defaults,f);a.each(function(){c(this).data(d,new c[d](this,b))});if(!c[d].initComplete){c(document).bind("mousemove touchmove",function(e){if(!c[d].currentlyClicking){return}e.preventDefault();var h=e.pageX||e.originalEvent.changedTouches[0].pageX;if(!c[d].dragging&&(Math.abs(c[d].dragStartPosition-h)>b.dragThreshold)){c[d].dragging=true}c(e.target).trigger("iPhoneDrag",[h])}).bind("mouseup touchend",function(e){if(!c[d].currentlyClicking){return}e.preventDefault();var h=e.pageX||e.originalEvent.changedTouches[0].pageX;c(c[d].currentlyClicking).trigger("iPhoneDragEnd",[h])});c[d].initComplete=true}return this};c[d].defaults={duration:200,checkedLabel:"ON",uncheckedLabel:"OFF",resizeHandle:true,resizeContainer:true,disabledClass:"iPhoneCheckDisabled",containerClass:"iPhoneCheckContainer",labelOnClass:"iPhoneCheckLabelOn",labelOffClass:"iPhoneCheckLabelOff",handleClass:"iPhoneCheckHandle",handleCenterClass:"iPhoneCheckHandleCenter",handleRightClass:"iPhoneCheckHandleRight",dragThreshold:5}})(jQuery,"iphoneStyle");